rules:
  - id: prefer-definetype-api
    pattern-either:
      - pattern: |
          export default {
            name: $NAME,
            type: "document",
            ...,
          }
      - pattern: |
          export default {
            name: $NAME,
            type: "object",
            ...,
          }
    message: |
      Prefer modern defineType() API for Sanity v3+ schema definitions.
      The defineType() helper provides better TypeScript inference and autocomplete support.

      Legacy object-literal pattern (v2-compatible):
        export default {
          name: 'blogPost',
          type: 'document',
          fields: [...]
        }

      Modern defineType API (v3+):
        import { defineType, defineField } from "sanity"

        export default defineType({
          name: 'blogPost',
          type: 'document',
          fields: [
            defineField({
              name: 'title',
              type: 'string',
              validation: (Rule) => Rule.required()
            })
          ]
        })

      Benefits:
      - Full TypeScript type inference
      - Better autocomplete in IDEs
      - Catches type errors at compile time
      - Clearer separation between defineType and defineField
    languages:
      - typescript
      - javascript
    severity: INFO
    metadata:
      category: sanity
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: MEDIUM
      subcategory:
        - best-practice
      references:
        - https://www.sanity.io/docs/schema-types
      source_confidence: 33%
      upgrade_version: v3+
